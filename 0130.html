<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>採購專案管理系統</title>
    <!-- 引入樣式 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入核心套件：React 必須在 Lucide 之前載入 -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- 引入 Lucide 核心庫 (純 JS 版最穩定) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- 引入 Babel 編譯器 -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
            margin: 0; padding: 0; color: #1e293b;
        }

        /* 專屬列印樣式：匯出橫向 A4 PDF */
        @media print {
            .no-print, button, .filter-bar, nav, header { display: none !important; }
            .min-h-screen { background-color: white !important; padding: 0 !important; }
            .max-w-\[1400px\] { max-width: 100% !important; margin: 0 !important; }
            .timeline-card { box-shadow: none !important; border: none !important; padding: 0 !important; }
            .timeline-header { margin-bottom: 30px !important; }
            @page { size: landscape; margin: 1.5cm; }
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        
        // --- 品牌與 UI 配置 ---
        const THEME = {
            purple: '#9B0070', teal: '#00919E', indigo: '#4F46E5', success: '#10B981',
            warning: '#F59E0B', danger: '#EF4444', planned: '#E2E8F0', overdue: '#FCA5A5'
        };

        const MONTHS = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];

        const STAGE_CONFIG = [
            { id: 1, name: '請購(簽呈)', category: 'demand', color: THEME.teal },
            { id: 2, name: '詢比議價', category: 'procurement', color: THEME.purple },
            { id: 3, name: '採購單簽核', category: 'procurement', color: THEME.purple },
            { id: 4, name: '合約作業', category: 'contract', color: THEME.indigo },
            { id: 5, name: '已完成/核准', category: 'contract', color: THEME.success }
        ];

        const STATUS_CONFIG = [
            { id: 'normal', name: '正常執行', color: THEME.success, icon: 'CheckCircle2' },
            { id: 'paused', name: '暫停中', color: THEME.warning, icon: 'PauseCircle' },
            { id: 'cancelled', name: '取消請購', color: THEME.danger, icon: 'StopCircle' }
        ];

        // --- 穩定版圖示元件：直接解析 Lucide 數據 ---
        const Icon = ({ name, size = 16, color = "currentColor", strokeWidth = 2, className = "" }) => {
            if (!window.lucide) return <div style={{ width: size, height: size }} className={className} />;
            
            // 將 PascalCase 轉換為 kebab-case (例如 CheckCircle2 -> check-circle-2)
            const kebabName = name.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();
            const iconData = window.lucide.icons[kebabName];
            
            if (!iconData) return <div style={{ width: size, height: size }} className={className} />;

            return (
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width={size}
                    height={size}
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke={color}
                    strokeWidth={strokeWidth}
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    className={className}
                    dangerouslySetInnerHTML={{
                        __html: iconData[1].map(tag => {
                            const [tagName, attrs] = tag;
                            const attrStr = Object.entries(attrs).map(([k, v]) => `${k}="${v}"`).join(' ');
                            return `<${tagName} ${attrStr}></${tagName}>`;
                        }).join('')
                    }}
                />
            );
        };

        const checkOverdue = (plannedEnd, actualEnd) => {
            if (!plannedEnd || !actualEnd) return false;
            return new Date(actualEnd) > new Date(plannedEnd);
        };

        const App = () => {
            const [viewMode, setViewMode] = useState('timeline'); 
            const [timelineDisplay, setTimelineDisplay] = useState('dual');
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [isSettingModalOpen, setIsSettingModalOpen] = useState(false);
            const [editingProject, setEditingProject] = useState(null);
            const [expandedProjectIds, setExpandedProjectIds] = useState(new Set());
            const [deleteConfirmId, setDeleteConfirmId] = useState(null); 

            // 組織資料
            const [departments, setDepartments] = useState(['資訊部', '總務部', '營繕組', '研發部', '行銷部']);
            const [handlers, setHandlers] = useState(['林小華', '張小芬', '趙小明']);
            const [newDeptInput, setNewDeptInput] = useState('');
            const [newHandlerInput, setNewHandlerInput] = useState('');

            // 篩選
            const [filterYear, setFilterYear] = useState('2026');
            const [filterStatus, setFilterStatus] = useState('All');
            const [filterHandler, setFilterHandler] = useState('All');
            const [searchTerm, setSearchTerm] = useState('');

            const availableYears = ['2026', '2027', '2028', '2029', '2030'];

            const [projects, setProjects] = useState([
                { 
                    id: 1, title: '行政大樓改裝工程', year: '2026', budget: 1500000, requester: '王大明', dept: '營繕組', handler: '林小華', stage: 2,
                    status: 'normal', remarks: '', hasSubTasks: true,
                    tasks: [
                        { 
                            id: 101, name: '隔間與硬體架構', status: 'normal', expanded: false, remarks: '',
                            planned: { demand: { start: '2026-01-05', end: '2026-01-25' }, procurement: { start: '2026-01-26', end: '2026-02-15' }, contract: { start: '2026-02-16', end: '2026-02-28' } },
                            actual: { demand: { start: '2026-01-05', end: '2026-01-28' }, procurement: { start: '2026-01-29', end: '' }, contract: { start: '', end: '' } }
                        }
                    ],
                    planned: { demand: { start: '2026-01-05', end: '2026-02-10' }, procurement: { start: '2026-02-11', end: '2026-04-20' }, contract: { start: '2026-04-21', end: '2026-06-30' } },
                    actual: { demand: { start: '2026-01-05', end: '2026-02-20' }, procurement: { start: '2026-02-21', end: '' }, contract: { start: '', end: '' } }
                }
            ]);

            const toggleProjectExpansion = (id) => {
                const newSet = new Set(expandedProjectIds);
                if (newSet.has(id)) newSet.delete(id);
                else newSet.add(id);
                setExpandedProjectIds(newSet);
            };

            const calculateBar = (start, end) => {
                if (!start || !end) return { left: '0%', width: '0%', display: 'none' };
                const viewYear = parseInt(filterYear);
                const startDate = new Date(start);
                const endDate = new Date(end);
                const yearStart = new Date(`${viewYear}-01-01`);
                const yearEnd = new Date(`${viewYear}-12-31`);
                if (endDate < yearStart || startDate > yearEnd) return { display: 'none' };
                const displayStart = startDate < yearStart ? yearStart : startDate;
                const displayEnd = endDate > yearEnd ? yearEnd : endDate;
                const dayOfYear = (date) => (date - yearStart) / (1000 * 60 * 60 * 24);
                const startPos = dayOfYear(displayStart);
                const endPos = dayOfYear(displayEnd) + 1;
                return { left: `${(startPos / 365) * 100}%`, width: `${((endPos - startPos) / 365) * 100}%` };
            };

            const filteredProjects = useMemo(() => {
                const getWeight = (p) => {
                    if (p.status === 'cancelled') return 4;
                    if (p.stage === 5) return 3;
                    if (p.status === 'paused') return 2;
                    return 1;
                };
                return projects
                    .filter(p => {
                        const matchYear = p.year === filterYear || 
                                          new Date(p.planned.demand.start).getFullYear().toString() === filterYear ||
                                          new Date(p.planned.contract.end).getFullYear().toString() === filterYear;
                        const matchSearch = p.title.toLowerCase().includes(searchTerm.toLowerCase());
                        const matchHandler = filterHandler === 'All' || p.handler === filterHandler;
                        const matchStatus = filterStatus === 'All' ? true : 
                                            filterStatus === 'Active' ? (p.status === 'normal' && p.stage < 5) : 
                                            filterStatus === 'Paused' ? p.status === 'paused' :
                                            filterStatus === 'Cancelled' ? p.status === 'cancelled' : 
                                            filterStatus === 'Completed' ? p.stage === 5 : true;
                        return matchYear && matchSearch && matchHandler && matchStatus;
                    })
                    .sort((a, b) => {
                        const weightA = getWeight(a);
                        const weightB = getWeight(b);
                        if (weightA !== weightB) return weightA - weightB;
                        return a.id - b.id; 
                    });
            }, [projects, searchTerm, filterHandler, filterStatus, filterYear]);

            const [newProject, setNewProject] = useState({
                title: '', year: '2026', budget: '', requester: '', dept: '', handler: '', stage: 1,
                status: 'normal', remarks: '', hasSubTasks: false,
                p_demandS: '', p_demandE: '', p_procS: '', p_procE: '', p_contS: '', p_contE: ''
            });

            const handleAddProject = (e) => {
                e.preventDefault();
                const project = {
                    id: Date.now(),
                    ...newProject,
                    dept: newProject.dept || departments[0],
                    handler: newProject.handler || handlers[0],
                    budget: newProject.budget ? Number(newProject.budget) : 0,
                    tasks: [],
                    planned: {
                        demand: { start: newProject.p_demandS, end: newProject.p_demandE },
                        procurement: { start: newProject.p_procS, end: newProject.p_procE },
                        contract: { start: newProject.p_contS, end: newProject.p_contE }
                    },
                    actual: { demand: { start: '', end: '' }, procurement: { start: '', end: '' }, contract: { start: '', end: '' } }
                };
                setProjects([...projects, project]);
                setIsModalOpen(false);
            };

            const addTask = (name) => {
                if (!name) return;
                const newTask = { 
                    id: Date.now(), name, expanded: true, status: 'normal', remarks: '',
                    planned: { 
                        demand: { start: editingProject.planned.demand.start, end: editingProject.planned.demand.end },
                        procurement: { start: editingProject.planned.procurement.start, end: editingProject.planned.procurement.end },
                        contract: { start: editingProject.planned.contract.start, end: editingProject.planned.contract.end }
                    },
                    actual: { demand: { start: '', end: '' }, procurement: { start: '', end: '' }, contract: { start: '', end: '' } }
                };
                setEditingProject({ ...editingProject, tasks: [...(editingProject.tasks || []), newTask] });
            };

            const updateTaskData = (taskId, category, field, subfield, value) => {
                const updatedTasks = editingProject.tasks.map(t => {
                    if (t.id === taskId) {
                        if (category === 'status' || category === 'remarks') return { ...t, [category]: value };
                        return { ...t, [field]: { ...t[field], [category]: { ...t[field][category], [subfield]: value } } };
                    }
                    return t;
                });
                setEditingProject({ ...editingProject, tasks: updatedTasks });
            };

            const updateProjectMain = (updatedProj) => {
                setProjects(projects.map(p => p.id === updatedProj.id ? updatedProj : p));
                setEditingProject(null);
            };

            const handleExport = () => { window.print(); };

            return (
                <div className="min-h-screen p-4 lg:p-10 tracking-tight print:bg-white print:p-0">
                    <div className="max-w-[1400px] mx-auto">
                        {/* Header */}
                        <header className="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-6 no-print">
                            <div className="flex items-center gap-6">
                                <div className="w-16 h-16 rounded-[2rem] flex items-center justify-center text-white shadow-xl" style={{ background: `linear-gradient(135deg, ${THEME.purple}, ${THEME.teal})` }}>
                                    <Icon name="Activity" size={32} strokeWidth={2.5} />
                                </div>
                                <div>
                                    <h1 className="text-3xl font-black text-slate-900 tracking-tighter uppercase font-black">採購專案管理</h1>
                                    <p className="text-slate-400 font-bold text-[10px] uppercase tracking-[0.4em] flex items-center gap-2 mt-1 font-black">
                                        <Icon name="Building2" size={14} /> KANG CHIAO • 智慧期程管控系統
                                    </p>
                                </div>
                            </div>
                            <div className="flex items-center gap-3 bg-white p-1.5 rounded-2xl shadow-sm border border-slate-200">
                                <button onClick={() => setViewMode('list')} className={`flex items-center gap-2 px-6 py-2.5 rounded-xl text-xs font-black transition-all ${viewMode === 'list' ? 'bg-slate-900 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-50'}`}>
                                    <Icon name="LayoutList" size={16} /> 案件清單
                                </button>
                                <button onClick={() => setViewMode('timeline')} className={`flex items-center gap-2 px-6 py-2.5 rounded-xl text-xs font-black transition-all ${viewMode === 'timeline' ? 'bg-slate-900 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-50'}`}>
                                    <Icon name="GanttChartSquare" size={16} /> 年度期程
                                </button>
                                <div className="w-[1px] h-6 bg-slate-200 mx-1"></div>
                                <button onClick={() => setIsModalOpen(true)} className="flex items-center gap-2 px-6 py-2.5 rounded-xl text-xs font-black text-white shadow-lg shadow-indigo-100 hover:brightness-110 active:scale-95 transition-all font-black" style={{ background: THEME.purple }}><Icon name="Plus" size={18} /> 新增案件</button>
                            </div>
                        </header>

                        {/* 核心篩選列 */}
                        <div className="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-6 items-center no-print filter-bar">
                            <div className="relative flex-1 w-full group search-container">
                                <Icon name="Search" size={20} className="absolute left-5 top-1/2 -translate-y-1/2 text-slate-300" />
                                <input type="text" placeholder="搜尋案件名稱、人員..." className="w-full pl-14 pr-6 py-3.5 bg-slate-50 border-none rounded-2xl outline-none font-medium text-sm focus:ring-2 focus:ring-indigo-500/10 transition-all font-black" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                            </div>
                            <div className="flex flex-wrap gap-4">
                                <div className="flex flex-col gap-1 font-black">
                                    <span className="text-[10px] font-black text-slate-300 uppercase tracking-widest pl-1 font-black">年度</span>
                                    <select className="bg-slate-50 border border-slate-100 rounded-xl px-4 py-2 text-sm font-bold outline-none cursor-pointer text-indigo-700 font-black" value={filterYear} onChange={(e) => setFilterYear(e.target.value)}>
                                        {availableYears.map(y => <option key={y} value={y}>{y} 年度</option>)}
                                    </select>
                                </div>
                                <div className="flex flex-col gap-1 font-black">
                                    <span className="text-[10px] font-black text-slate-300 uppercase tracking-widest pl-1 font-black">承辦人員</span>
                                    <select className="bg-slate-50 border border-slate-100 rounded-xl px-4 py-2 text-sm font-bold outline-none cursor-pointer text-indigo-700 font-bold font-black" value={filterHandler} onChange={(e) => setFilterHandler(e.target.value)}>
                                        <option value="All">全部人員</option>
                                        {handlers.map(h => <option key={h} value={h}>{h}</option>)}
                                    </select>
                                </div>
                                <div className="flex flex-col gap-1 font-black">
                                    <span className="text-[10px] font-black text-slate-300 uppercase tracking-widest pl-1 font-black">案件狀態</span>
                                    <select className="bg-slate-50 border border-slate-100 rounded-xl px-4 py-2 text-sm font-bold outline-none cursor-pointer text-indigo-700 font-bold font-black" value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}>
                                        <option value="All">全部狀態</option>
                                        <option value="Active">執行中</option>
                                        <option value="Paused">暫停中</option>
                                        <option value="Cancelled">已取消</option>
                                        <option value="Completed">已結案</option>
                                    </select>
                                </div>
                                <div className="pt-4 flex items-center no-print">
                                    <button onClick={() => setIsSettingModalOpen(true)} className="p-3.5 bg-slate-50 text-slate-400 rounded-xl border border-slate-100 hover:text-indigo-600 hover:bg-white transition-all shadow-sm"><Icon name="Settings2" size={22} /></button>
                                </div>
                            </div>
                        </div>

                        {viewMode === 'list' ? (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 animate-fade-in">
                                {filteredProjects.map(p => {
                                    const stage = STAGE_CONFIG.find(s => s.id === p.stage) || STAGE_CONFIG[0];
                                    const statusObj = STATUS_CONFIG.find(s => s.id === p.status) || STATUS_CONFIG[0];
                                    return (
                                        <div key={p.id} className={`bg-white rounded-[2.5rem] shadow-sm border border-slate-100 transition-all relative overflow-hidden group ${p.status === 'cancelled' ? 'opacity-60 grayscale' : 'hover:shadow-xl hover:-translate-y-1'}`}>
                                            <button onClick={(e) => { e.stopPropagation(); setDeleteConfirmId(p.id); }} className="absolute top-6 right-6 p-2 bg-rose-50 text-rose-300 hover:text-rose-600 rounded-xl transition-all z-20 opacity-0 group-hover:opacity-100 shadow-sm no-print"><Icon name="Trash2" size={16} /></button>
                                            <div className="p-8 cursor-pointer" onClick={() => setEditingProject(p)}>
                                                <div className="flex justify-between items-start mb-6 font-black">
                                                    <div className="flex flex-col gap-2 font-black">
                                                        <span className="px-3 py-1 bg-indigo-50 text-indigo-500 text-[10px] font-black rounded-lg uppercase tracking-widest font-black font-bold">{p.dept}</span>
                                                        {p.status !== 'normal' && <span className="inline-flex items-center gap-1 px-2 py-0.5 rounded text-[9px] font-black text-white font-black" style={{ backgroundColor: statusObj.color }}><Icon name={statusObj.icon} size={10} /> {statusObj.name}</span>}
                                                    </div>
                                                    <div className="w-10 h-10 rounded-2xl bg-slate-50 text-slate-400 flex items-center justify-center font-black text-xs border border-slate-100 shadow-inner font-black">{p.handler[0]}</div>
                                                </div>
                                                <h3 className={`text-xl font-black text-slate-900 mb-2 leading-tight font-black ${p.status === 'cancelled' ? 'line-through text-slate-300' : ''}`}>{p.title}</h3>
                                                <div className="text-2xl font-black text-indigo-600 mb-6 tracking-tight font-black">{p.budget ? `$${p.budget.toLocaleString()}` : <span className="text-slate-200 text-sm font-black italic">預算未填</span>}</div>
                                                <div className="space-y-4 pt-6 border-t border-slate-50 font-black">
                                                    <div className="flex justify-between items-end font-black"><div className="text-[10px] font-black text-slate-300 uppercase tracking-widest font-black">主流程進度</div><div className="text-xs font-black font-bold" style={{ color: p.status === 'cancelled' ? '#cbd5e1' : stage.color }}>{stage.name}</div></div>
                                                    <div className="h-2 bg-slate-50 rounded-full flex gap-1 p-[2px]">
                                                        {STAGE_CONFIG.map(s => (<div key={s.id} className="flex-1 rounded-full" style={{ backgroundColor: s.id <= p.stage ? (p.status === 'cancelled' ? '#e2e8f0' : s.color) : 'transparent', opacity: s.id === p.stage ? 1 : 0.3 }}></div>))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        ) : (
                            <div className="bg-white rounded-[2.5rem] shadow-sm border border-slate-100 p-10 overflow-x-auto timeline-card animate-fade-in font-black font-bold font-black">
                                <div className="min-w-[1200px]">
                                    <div className="flex flex-col md:flex-row justify-between items-end mb-12 px-4 border-b border-slate-50 pb-10 timeline-header font-black">
                                        <div className="mb-4 md:mb-0">
                                           <p className="text-[10px] font-black text-slate-300 uppercase tracking-widest mb-1 font-black">年度採購計畫追蹤大表</p>
                                           <h4 className="text-2xl font-black text-slate-800 tracking-tighter font-black">{filterYear} 年度軌跡</h4>
                                        </div>
                                        <div className="flex items-center gap-6 no-print">
                                            <div className="flex bg-slate-100 p-1.5 rounded-2xl border border-slate-200 shadow-inner">
                                                <button onClick={() => setTimelineDisplay('dual')} className={`flex items-center gap-2 px-5 py-2 rounded-xl text-[11px] font-black transition-all ${timelineDisplay === 'dual' ? 'bg-white text-purple-700 shadow-md scale-105 font-black' : 'text-slate-400 hover:text-slate-600'}`}>
                                                    <Icon name="Layers" size={14} /> 計畫對比
                                                </button>
                                                <button onClick={() => setTimelineDisplay('actual')} className={`flex items-center gap-2 px-5 py-2 rounded-xl text-[11px] font-black transition-all ${timelineDisplay === 'actual' ? 'bg-white text-purple-700 shadow-md scale-105 font-black' : 'text-slate-400 hover:text-slate-600'}`}>
                                                    <Icon name="Eye" size={14} /> 僅看實際
                                                </button>
                                            </div>
                                            <button onClick={handleExport} className="flex items-center gap-3 px-8 py-3 text-white rounded-2xl text-[12px] font-black shadow-xl hover:brightness-110 active:scale-95 transition-all font-black font-bold" style={{ background: THEME.purple }}><Icon name="Printer" size={18} /> 匯出圖表</button>
                                        </div>
                                    </div>

                                    <div className="flex items-center mb-8 px-4 font-black">
                                        <div className="w-[300px] flex-shrink-0 font-black"><span className="text-[10px] font-black text-slate-300 uppercase tracking-[0.3em]">專案名稱</span></div>
                                        <div className="flex-1 grid grid-cols-12 text-center">
                                            {MONTHS.map(m => (<div key={m} className="text-[10px] font-black text-slate-400 uppercase border-l border-slate-50 h-6 flex items-center justify-center font-black tracking-widest">{m}</div>))}
                                        </div>
                                    </div>

                                    <div className="space-y-10 font-black">
                                        {filteredProjects.map(p => {
                                            const isExpanded = expandedProjectIds.has(p.id);
                                            return (
                                                <div key={p.id} className="space-y-4 font-black font-bold">
                                                    <div className={`flex items-center gap-8 group ${p.status === 'cancelled' ? 'opacity-40' : ''}`}>
                                                        <div className="w-[300px] flex-shrink-0 flex items-center gap-4 px-4">
                                                            <button onClick={() => p.hasSubTasks && toggleProjectExpansion(p.id)} className={`p-1.5 rounded-lg transition-all no-print ${p.hasSubTasks ? 'hover:bg-slate-100 text-slate-400' : 'opacity-0'}`}>{isExpanded ? <Icon name="ChevronDown" size={20}/> : <Icon name="ChevronRight" size={20}/>}</button>
                                                            <div className="cursor-pointer" onClick={()=>setEditingProject(p)}>
                                                                <div className="font-black text-slate-800 group-hover:text-purple-700 transition-colors text-sm font-black">{p.title}</div>
                                                                <div className="text-[9px] font-black text-slate-400 uppercase tracking-widest mt-1 flex items-center gap-1 font-black"><Icon name="User" size={10} className="text-teal-500 font-black" /> {p.handler}</div>
                                                            </div>
                                                        </div>
                                                        <div className="flex-1 relative h-12 flex items-center">
                                                            {timelineDisplay === 'dual' && (
                                                                <div className="absolute top-0 w-full h-full bg-slate-50/50 rounded-xl overflow-hidden opacity-30 border border-slate-100 shadow-inner">
                                                                    <div className="absolute top-0 h-full bg-slate-400" style={calculateBar(p.planned.demand.start, p.planned.demand.end)}></div>
                                                                    <div className="absolute top-0 h-full bg-slate-500" style={calculateBar(p.planned.procurement.start, p.planned.procurement.end)}></div>
                                                                    <div className="absolute top-0 h-full bg-slate-600" style={calculateBar(p.planned.contract.start, p.planned.contract.end)}></div>
                                                                </div>
                                                            )}
                                                            <div className={`absolute w-full flex items-center pointer-events-none ${timelineDisplay === 'dual' ? 'top-3 bottom-3' : 'top-0 bottom-0'}`}>
                                                                {['demand', 'procurement', 'contract'].map((cat, i) => {
                                                                    const colors = [THEME.teal, THEME.purple, THEME.indigo];
                                                                    const isOver = checkOverdue(p.planned[cat].end, p.actual[cat].end);
                                                                    return (<div key={cat} className={`absolute h-full transition-all duration-700 shadow-md ${i===0?'rounded-l-lg':i===2?'rounded-r-lg':''} ${isOver && timelineDisplay === 'dual' ? 'ring-2 ring-rose-500 ring-offset-2' : ''}`} style={{ ...calculateBar(p.actual[cat].start, p.actual[cat].end), backgroundColor: (isOver && timelineDisplay === 'dual') ? THEME.danger : colors[i] }}></div>);
                                                                })}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {isExpanded && p.tasks.map(t => (
                                                        <div key={t.id} className="flex items-center gap-8 animate-fade-in pl-10 opacity-80 font-bold">
                                                            <div className="w-[260px] flex-shrink-0 flex items-center gap-3 px-4 font-black">
                                                                <span className="text-[11px] text-slate-500 font-bold">{t.name}</span>
                                                            </div>
                                                            <div className="flex-1 relative h-6 font-black font-bold">
                                                                {timelineDisplay === 'dual' && (
                                                                    <div className="absolute top-0 w-full h-full bg-slate-50/20 rounded-lg overflow-hidden opacity-20 border border-slate-50">
                                                                        <div className="absolute h-full bg-slate-400" style={calculateBar(t.planned.demand.start, t.planned.demand.end)}></div>
                                                                    </div>
                                                                )}
                                                                <div className={`absolute w-full flex items-center pointer-events-none ${timelineDisplay === 'dual' ? 'top-1 bottom-1' : 'top-0 bottom-0'}`}>
                                                                    {['demand', 'procurement', 'contract'].map((cat, i) => (
                                                                        <div key={cat} className={`absolute h-full rounded-full opacity-60 shadow-sm`} style={{ ...calculateBar(t.actual[cat].start, t.actual[cat].end), backgroundColor: [THEME.teal, THEME.purple, THEME.indigo][i] }}></div>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* 詳細管理視窗 */}
                        {editingProject && (
                            <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-xl flex items-center justify-center p-4 z-[100] no-print">
                                <div className="bg-white rounded-[3rem] w-full max-w-7xl shadow-2xl border border-white/20 flex flex-col max-h-[95vh] overflow-hidden animate-fade-in font-black">
                                    <div className="p-8 border-b border-slate-50 flex justify-between items-center bg-white z-10 font-black">
                                        <div className="flex items-center gap-6 font-black font-bold"><div className="w-14 h-14 rounded-[1.5rem] flex items-center justify-center text-white shadow-lg" style={{ background: THEME.purple }}><Icon name="Layers" size={24} /></div><div><h2 className="text-2xl font-black text-slate-900 font-black">{editingProject.title}</h2><p className="text-[10px] font-black text-purple-600 uppercase tracking-widest mt-1 font-bold">案件詳細管理與填報</p></div></div>
                                        <button onClick={() => setEditingProject(null)} className="p-3 bg-slate-50 text-slate-400 rounded-full hover:bg-slate-100 transition-colors shadow-sm font-black"><Icon name="X" size={24} /></button>
                                    </div>
                                    <div className="flex-1 overflow-y-auto p-10 grid grid-cols-1 lg:grid-cols-12 gap-10 bg-slate-50/20 custom-scrollbar font-black">
                                        <div className={`${editingProject.hasSubTasks ? 'lg:col-span-6' : 'hidden'} space-y-6`}>
                                           <h3 className="text-[11px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 font-bold font-black"><HardHat size={16} className="text-purple-600 font-black"/> 分項工程管理</h3>
                                           <div className="space-y-4 font-black">
                                              <div className="flex gap-2">
                                                <input id="sub-input" placeholder="名稱..." className="flex-1 bg-white border border-slate-200 rounded-2xl px-5 py-3 text-sm font-bold outline-none shadow-sm focus:ring-4 focus:ring-indigo-500/5 transition-all font-black font-black font-black" onKeyDown={(e)=> { if(e.key==='Enter') { addTask(e.target.value); e.target.value=''; } }} />
                                                <button onClick={()=>{const el=document.getElementById('sub-input'); addTask(el.value); el.value='';}} className="bg-indigo-600 text-white p-3 rounded-2xl shadow-lg hover:brightness-110 active:scale-95 transition-all font-black font-black font-black font-bold"><Icon name="Plus" /></button>
                                              </div>
                                              <div className="space-y-4 font-bold font-black">
                                                {editingProject.tasks.map(t => (
                                                  <div key={t.id} className="bg-white rounded-3xl border border-slate-100 shadow-sm overflow-hidden transition-all duration-300 font-black font-bold">
                                                     <div className="p-5 flex justify-between items-center cursor-pointer hover:bg-slate-50 transition-colors font-bold font-black" onClick={()=>{ const updated = editingProject.tasks.map(x=>x.id===t.id?{...x,expanded:!x.expanded}:x); setEditingProject({...editingProject, tasks:updated}); }}>
                                                        <div className="flex items-center gap-3 font-bold text-slate-700 text-sm font-black"><span>{t.name}</span></div>
                                                        <div className="flex gap-2 font-black"><button onClick={(e)=>{e.stopPropagation(); setEditingProject({...editingProject, tasks: editingProject.tasks.filter(x=>x.id!==t.id)});}} className="text-slate-200 hover:text-rose-500 transition-colors font-black"><Icon name="Trash2" size={16}/></button><Icon name={t.expanded ? "ChevronUp" : "ChevronDown"} /></div>
                                                     </div>
                                                     {t.expanded && (
                                                       <div className="p-6 pt-0 border-t border-slate-50 space-y-6">
                                                          {['demand', 'procurement', 'contract'].map((cat, i) => (
                                                            <div key={cat} className="space-y-3 font-black">
                                                               <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest font-bold">{i+1}. {STAGE_CONFIG.find(s=>s.category === (cat==='procurement'?'procurement':cat==='contract'?'contract':'demand')).name}</span>
                                                               <div className="grid grid-cols-2 gap-4">
                                                                  <div className="flex flex-col gap-1 font-bold font-black font-bold font-black"><label className="text-[8px] font-black text-slate-300 uppercase pl-1 font-black">計畫期程</label><div className="flex gap-1 bg-slate-50 p-2 rounded-xl font-black font-bold font-black"><input type="date" className="bg-transparent border-none text-[10px] font-bold text-slate-400 w-full font-black" value={t.planned[cat].start} onChange={(e)=>updateTaskData(t.id,cat,'planned','start',e.target.value)} /><input type="date" className="bg-transparent border-none text-[10px] font-bold text-slate-400 w-full font-black font-black" value={t.planned[cat].end} onChange={(e)=>updateTaskData(t.id,cat,'planned','end',e.target.value)} /></div></div>
                                                                  <div className="flex flex-col gap-1 font-bold font-black font-bold font-black"><label className="text-[8px] font-black text-indigo-400 uppercase pl-1 font-black font-black font-black">實際執行</label><div className="flex gap-1 border border-indigo-100 bg-white rounded-xl p-2 shadow-sm font-black font-bold font-black"><input type="date" className="bg-transparent border-none text-[10px] font-black text-slate-700 w-full outline-none font-black font-black font-black" value={t.actual[cat].start} onChange={(e)=>updateTaskData(t.id,cat,'actual','start',e.target.value)} /><input type="date" className="bg-transparent border-none text-[10px] font-black text-slate-700 w-full outline-none font-black font-black font-black" value={t.actual[cat].end} onChange={(e)=>updateTaskData(t.id,cat,'actual','end',e.target.value)} /></div></div>
                                                               </div>
                                                            </div>
                                                          ))}
                                                       </div>
                                                     )}
                                                  </div>
                                                ))}
                                              </div>
                                           </div>
                                        </div>
                                        <div className={`${editingProject.hasSubTasks ? 'lg:col-span-6' : 'lg:col-span-12'} space-y-8 font-black font-bold font-black`}>
                                           <section className="bg-white p-8 rounded-[2.5rem] border border-slate-100 shadow-sm space-y-8 font-black font-bold">
                                              <h3 className="text-[11px] font-black text-slate-400 uppercase flex items-center gap-2 font-black font-bold"><Icon name="Layers" size={18} className="text-indigo-600 font-black font-black font-black font-black"/> 流程進度切換</h3>
                                              <div className="grid grid-cols-5 gap-2 font-black font-black">
                                                {STAGE_CONFIG.map(s => (<button key={s.id} onClick={()=>setEditingProject({...editingProject, stage:s.id})} className={`flex flex-col items-center p-4 rounded-2xl border transition-all ${editingProject.stage === s.id ? 'bg-indigo-600 text-white shadow-lg scale-105 border-transparent font-black font-black font-black' : 'bg-slate-50 text-slate-400 border-transparent hover:bg-slate-100 shadow-inner'}`}><span className="text-[9px] font-black mb-1 opacity-60 uppercase font-black">S{s.id}</span><span className="text-[10px] font-bold text-center leading-tight font-black font-black font-black">{s.name}</span></button>))}
                                              </div>
                                           </section>
                                           <section className="bg-white p-8 rounded-[2.5rem] border border-slate-100 shadow-sm space-y-8 font-black font-black font-black">
                                              <h3 className="text-[11px] font-black text-slate-400 uppercase flex items-center gap-2 tracking-widest font-black font-bold font-black font-black font-black font-black font-black"><Icon name="History" size={18} className="text-indigo-600 font-black font-black font-black"/> 主計畫雙軌期程填報</h3>
                                              {['demand', 'procurement', 'contract'].map((cat, idx) => (
                                                <div key={cat} className="space-y-4 font-black">
                                                   <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest font-black font-bold font-black font-black font-black">{idx+1}. {STAGE_CONFIG.find(s=>s.category === (cat==='procurement'?'procurement':cat==='contract'?'contract':'demand')).name}</span>
                                                   <div className="grid grid-cols-2 gap-6 font-black font-bold font-black">
                                                      <div className="bg-slate-50 p-4 rounded-2xl border border-slate-100 font-black font-bold font-black font-black"><label className="text-[9px] font-black text-slate-300 uppercase block mb-2 tracking-widest font-black font-black font-black font-black font-black">計畫日期</label><div className="flex gap-2 font-black font-bold"><input type="date" className="text-[11px] font-bold text-slate-400 bg-transparent border-none p-0 w-full" value={editingProject.planned[cat].start} onChange={(e)=>setEditingProject({...editingProject, planned:{...editingProject.planned, [cat]:{...editingProject.planned[cat], start: e.target.value}}})} /><span>~</span><input type="date" className="text-[11px] font-bold text-slate-400 bg-transparent border-none p-0 w-full font-black font-black" value={editingProject.planned[cat].end} onChange={(e)=>setEditingProject({...editingProject, planned:{...editingProject.planned, [cat]:{...editingProject.planned[cat], end: e.target.value}}})} /></div></div>
                                                      <div className="bg-white p-4 rounded-2xl border-2 border-indigo-100 shadow-lg shadow-indigo-50 font-black font-bold font-black font-black font-black font-black"><label className="text-[9px] font-black text-indigo-400 uppercase block mb-2 tracking-widest font-black font-black font-black font-black font-black">實際完成</label><div className="flex gap-2 font-black font-bold font-black font-black"><input type="date" className="text-[11px] font-black text-slate-800 bg-transparent border-none p-0 w-full font-black font-black font-black" value={editingProject.actual[cat].start} onChange={(e)=>setEditingProject({...editingProject, actual:{...editingProject.actual, [cat]:{...editingProject.actual[cat], start: e.target.value}}})} /><span>~</span><input type="date" className="text-[11px] font-black text-slate-800 bg-transparent border-none p-0 w-full font-black font-black font-black font-black" value={editingProject.actual[cat].end} onChange={(e)=>setEditingProject({...editingProject, actual:{...editingProject.actual, [cat]:{...editingProject.actual[cat], end: e.target.value}}})} /></div></div>
                                                   </div>
                                                </div>
                                              ))}
                                           </section>
                                        </div>
                                    </div>
                                    <div className="p-8 border-t border-slate-50 flex justify-end gap-4 bg-white shadow-inner font-black">
                                        <button onClick={()=>setEditingProject(null)} className="px-10 py-3.5 rounded-2xl text-slate-400 font-bold hover:bg-slate-50 transition-all uppercase font-black">取消返回</button>
                                        <button onClick={()=>{ updateProjectMain(editingProject); }} className="px-14 py-3.5 rounded-2xl text-white font-black shadow-xl shadow-indigo-100 hover:brightness-110 active:scale-95 transition-all font-black font-black font-black font-black" style={{ background: THEME.purple }}>確認更新資料</button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* 新增案件視窗 */}
                        {isModalOpen && (
                            <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-xl flex items-center justify-center p-4 z-[100] overflow-y-auto no-print font-black font-bold font-black font-black font-black">
                                <div className="bg-white rounded-[3rem] w-full max-w-4xl p-12 shadow-2xl relative border border-white/20 my-10 animate-fade-in font-black font-bold font-black">
                                    <button onClick={()=>setIsModalOpen(false)} className="absolute right-10 top-10 p-3 bg-slate-50 rounded-full text-slate-300 shadow-sm font-black font-black font-black"><Icon name="X" /></button>
                                    <h2 className="text-3xl font-black mb-10 font-bold font-black font-black tracking-tighter" style={{ color: THEME.purple }}>啟動全新採購計畫</h2>
                                    <form onSubmit={handleAddProject} className="grid grid-cols-1 md:grid-cols-2 gap-10 font-black font-black">
                                        <div className="space-y-8 font-black font-black font-black">
                                            <input required className="w-full bg-slate-50 border-none rounded-2xl px-6 py-5 text-sm font-bold shadow-inner font-black font-bold" placeholder="案件標題..." value={newProject.title} onChange={(e)=>setNewProject({...newProject, title: e.target.value})} />
                                            <div className="grid grid-cols-2 gap-4 font-black">
                                                <input type="number" className="w-full bg-slate-50 border-none rounded-2xl px-6 py-5 text-sm font-bold shadow-inner font-black font-bold" placeholder="預算額度..." value={newProject.budget} onChange={(e)=>setNewProject({...newProject, budget: e.target.value})} />
                                                <select className="w-full bg-slate-50 border-none rounded-2xl px-6 py-5 text-sm font-bold shadow-inner font-black font-bold" value={newProject.year} onChange={(e)=>setNewProject({...newProject, year: e.target.value})}>{availableYears.map(y => <option key={y} value={y}>{y} 年度</option>)}</select>
                                            </div>
                                            <select required className="w-full bg-slate-50 border-none rounded-2xl px-6 py-5 text-sm font-bold shadow-inner cursor-pointer font-black font-black font-black font-bold" value={newProject.handler} onChange={(e)=>setNewProject({...newProject, handler: e.target.value})}><option value="">主責人員</option>{handlers.map(h => <option key={h} value={h}>{h}</option>)}</select>
                                            <div className="p-6 bg-slate-50 rounded-[2rem] flex items-center justify-between border border-slate-100 shadow-inner font-black font-black font-black font-black">
                                                <p className="text-sm font-black text-slate-700 font-bold font-black">啟用分項工程管理</p>
                                                <button type="button" onClick={()=>setNewProject({...newProject, hasSubTasks: !newProject.hasSubTasks})}>{newProject.hasSubTasks ? <Icon name="ToggleRight" size={42} className="text-indigo-600" /> : <Icon name="ToggleLeft" size={42} className="text-slate-300" />}</button>
                                            </div>
                                        </div>
                                        <div className="bg-slate-50 p-8 rounded-[2.5rem] space-y-6 shadow-inner border border-slate-100 font-black font-bold font-black">
                                            <h3 className="text-xs font-black text-slate-400 uppercase tracking-[0.2em] font-bold font-black font-black font-black font-black font-black font-black"><Icon name="CalendarDays" size={16} className="text-purple-600 mr-2 inline font-black font-black" /> 計畫規畫期程</h3>
                                            {[{key:'demand',label:'1. 需求階段'},{key:'proc',label:'2. 採購階段'},{key:'cont',label:'3. 合約階段'}].map((item) => (
                                                <div key={item.key} className="space-y-2 font-black font-bold font-black font-black">
                                                    <p className="text-[10px] font-black text-slate-500 uppercase tracking-widest pl-1 font-black">{item.label}</p>
                                                    <div className="flex gap-2 font-black font-bold"><input type="date" required className="flex-1 text-[10px] p-3 rounded-xl border-none font-bold font-black shadow-sm font-black font-black" value={newProject[`p_${item.key}S`]} onChange={(e)=>{ const next={...newProject}; next[`p_${item.key}S`]=e.target.value; setNewProject(next); }} /><input type="date" required className="flex-1 text-[10px] p-3 rounded-xl border-none font-bold font-black shadow-sm font-black font-black" value={newProject[`p_${item.key}E`]} onChange={(e)=>{ const next={...newProject}; next[`p_${item.key}E`]=e.target.value; setNewProject(next); }} /></div>
                                                </div>
                                            ))}
                                        </div>
                                        <button type="submit" className="md:col-span-2 py-6 rounded-[1.5rem] text-white font-black text-xl shadow-2xl hover:brightness-110 active:scale-95 transition-all font-black font-bold font-black font-black font-black font-black font-black" style={{ background: THEME.purple }}>完成發布案件</button>
                                    </form>
                                </div>
                            </div>
                        )}

                        {/* 組織設定管理 */}
                        {isSettingModalOpen && (
                            <div className="fixed inset-0 bg-slate-900/40 backdrop-blur-md flex items-center justify-center p-4 z-[100] no-print font-black font-bold font-black">
                                <div className="bg-white rounded-[2.5rem] w-full max-w-2xl p-10 shadow-2xl border border-white/20 animate-fade-in font-black">
                                    <div className="flex justify-between items-center mb-10 font-black"><h2 className="text-2xl font-black flex items-center gap-3 text-slate-800 font-black tracking-tighter font-black font-black font-black font-black"><Icon name="Settings2" style={{ color: THEME.purple }}/> 組織設定管理</h2><button onClick={() => setIsSettingModalOpen(false)} className="bg-slate-50 p-3 rounded-full text-slate-400 hover:text-slate-600 shadow-sm font-black font-black font-black font-black"><Icon name="X" /></button></div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-10 font-black font-black font-black">
                                        <div className="space-y-4 font-black font-black font-black">
                                            <h3 className="text-xs font-black text-slate-400 uppercase tracking-widest font-black font-bold font-black font-black font-black font-black font-black font-black"><Icon name="Building2" size={14} className="inline mr-1" /> 需求部門維護</h3>
                                            <div className="flex gap-2 font-black font-black font-black font-black font-black font-black font-black">
                                                <input className="flex-1 bg-slate-50 border border-slate-100 rounded-xl px-4 py-3 text-xs font-bold font-black font-bold font-black font-black font-black font-black font-black font-black" placeholder="新部門..." value={newDeptInput} onChange={(e)=>setNewDeptInput(e.target.value)} onKeyDown={(e)=> {if(e.key==='Enter' && newDeptInput) {setDepartments([...departments, newDeptInput]); setNewDeptInput('');}}} />
                                                <button onClick={()=>{if(newDeptInput){setDepartments([...departments, newDeptInput]); setNewDeptInput('');}}} className="bg-indigo-600 text-white p-3 rounded-xl shadow-md font-black font-bold font-black font-black font-black font-black font-black"><Icon name="Plus" size={18}/></button>
                                            </div>
                                            <div className="max-h-60 overflow-y-auto space-y-2 custom-scrollbar font-black font-bold font-black font-black font-black font-black font-black font-black">{departments.map(d=>(<div key={d} className="flex justify-between items-center bg-slate-50 p-3 rounded-2xl border border-slate-100 shadow-sm font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><span className="text-sm font-bold text-slate-700 font-black font-black font-black font-black">{d}</span><button onClick={()=>setDepartments(departments.filter(x=>x !== d))} className="text-rose-500 font-black font-black font-black font-black font-black font-black"><Icon name="Trash2" size={14}/></button></div>))}</div>
                                        </div>
                                        <div className="space-y-4 border-l border-slate-100 pl-8 font-black font-black font-black font-black font-black font-black font-black">
                                            <h3 className="text-xs font-black text-slate-400 uppercase tracking-widest font-black font-bold font-black font-black font-black font-black font-black font-black"><Icon name="User" size={14} className="inline mr-1" /> 採購夥伴名冊</h3>
                                            <div className="flex gap-2 font-black font-black font-black font-black font-black font-black font-black">
                                                <input className="flex-1 bg-slate-50 border border-slate-100 rounded-xl px-4 py-3 text-xs font-bold font-black font-bold font-black font-bold font-black font-black font-black font-black font-black font-black" placeholder="姓名..." value={newHandlerInput} onChange={(e)=>setNewHandlerInput(e.target.value)} onKeyDown={(e)=> {if(e.key==='Enter' && newHandlerInput) {setHandlers([...handlers, newHandlerInput]); setNewHandlerInput('');}}} />
                                                <button onClick={()=>{if(newHandlerInput){setHandlers([...handlers, newHandlerInput]); setNewHandlerInput('');}}} className="bg-indigo-600 text-white p-3 rounded-xl shadow-md font-black font-bold font-black font-black font-black font-black font-black font-black font-black"><Icon name="Plus" size={18}/></button>
                                            </div>
                                            <div className="max-h-60 overflow-y-auto space-y-2 custom-scrollbar font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{handlers.map(h=>(<div key={h} className="flex justify-between items-center bg-indigo-50/30 p-3 rounded-2xl border border-indigo-50 shadow-sm font-black font-bold font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><span className="text-sm font-bold text-indigo-900 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{h}</span><button onClick={()=>setHandlers(handlers.filter(x=>x !== h))} className="text-rose-500 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><Icon name="Trash2" size={14}/></button></div>))}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {/* 刪除確認 */}
                        {deleteConfirmId && (
                            <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-md flex items-center justify-center p-4 z-[200] no-print font-black font-bold font-black font-black font-black font-black font-black font-black">
                                <div className="bg-white rounded-[3rem] w-full max-w-sm p-10 shadow-2xl text-center space-y-6 animate-fade-in font-black font-bold font-black">
                                    <div className="w-20 h-20 bg-rose-50 text-rose-600 rounded-3xl flex items-center justify-center mx-auto animate-bounce font-black font-bold font-black font-black font-black font-black font-black font-black font-black font-black"><Icon name="AlertOctagon" size={40}/></div>
                                    <h3 className="text-2xl font-black text-slate-900 font-black font-bold font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">確定刪除此案件？</h3>
                                    <div className="flex flex-col gap-3 font-black font-bold font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><button onClick={()=>deleteProject(deleteConfirmId)} className="w-full py-4 bg-rose-600 text-white rounded-2xl font-black active:scale-95 transition-all font-black font-bold font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">確認永久刪除</button><button onClick={()=>setDeleteConfirmId(null)} className="w-full py-4 bg-slate-50 text-slate-400 rounded-2xl font-bold font-black font-bold font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">返回保留</button></div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
